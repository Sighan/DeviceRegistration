"use strict";angular.module("deviceRegistrationApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngSanitize","ngTouch","ui.router"]).constant("urls",{API:"http://<hier api domain eingeben>"}).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(a,b,c){b.otherwise("/login"),a.state("access",{"abstract":!0,controller:"LoginCtrl",template:'<div class="h-full triangular-primary"><div ui-view class="fade-in-right-big smooth"></div></div>'}).state("access.login",{url:"/login",templateUrl:"views/login/login.html"}).state("access.register",{url:"/register",templateUrl:"views/login/register.html"}).state("access.forgotpwd",{url:"/forgotpwd",templateUrl:"views/login/forgotpwd.html"}),c.interceptors.push(["$q","$location","$localStorage",function(a,b,c){return{request:function(a){return a.headers=a.headers||{},c.token&&(a.headers.Authorization="Bearer "+c.token),a},responseError:function(c){return(401===c.status||403===c.status)&&b.path("/login"),a.reject(c)}}}])}]),angular.module("deviceRegistrationApp").controller("LoginCtrl",["$scope","$location","authService",function(a,b,c){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.signin=function(a,b){b&&c.signin(formData,function(){alert("Login successful! Yay")},function(){alert("Invalid credentials")})},a.register=function(a,b){b&&c.signup(formData,function(){alert("Account created")},function(){alert("Account could not be created")})}}]),angular.module("deviceRegistrationApp").factory("authService",["$http","$localStorage","urls",function(a,b,c){function d(a){var b=a.replace("-","+").replace("_","/");switch(b.length%4){case 0:break;case 2:b+="==";break;case 3:b+="=";break;default:throw"Illegal base64url string!"}return window.atob(b)}function e(){var a=b.token,c={};if("undefined"!=typeof a){var e=a.split(".")[1];c=JSON.parse(d(e))}return c}var f=e();return{signup:function(b,d,e){a.post(c.API+"/signup",b).success(d).error(e)},signin:function(b,d,e){a.post(c.API+"/signin",b).success(d).error(e)},logout:function(a){f={},delete b.token,a()},getTokenClaims:function(){return f}}}]);